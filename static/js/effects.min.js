!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("scenejs")):"function"==typeof define&&define.amd?define(["exports","scenejs"],t):t((e=e||self).Scene=e.Scene||{},e.Scene)}(this,(function(e,t){"use strict";function r(e){return Array.isArray(e)}function n(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var r=t[1],n=t[2];return{prefix:r,unit:t[3],value:parseFloat(n)}}function o(e){return[].slice.call(e)}var i=CSSRule.KEYFRAMES_RULE||CSSRule.WEBKIT_KEYFRAMES_RULE,a=CSSRule.KEYFRAME_RULE||CSSRule.WEBKIT_KEYFRAME_RULE;function c(e,r,n){for(var o=new t.SceneItem({},n),i=r.length,a=0;a<i;++a)o.set(a/(i-1)*100+"%",e,r[a]);return o}function s(e){var r,n=void 0===e?{}:e,o=n.x,i=void 0===o?1:o,a=n.y,c=void 0===a?1:a,s=n.backside,u=void 0!==s&&s,f=new t.SceneItem({},arguments[0]),v="",d="",p="",l=i&&c||i?i:c,y=u?l>0?180:-180:0,m=y+180*l;if(i&&c){var x=[i>0?1:-1,c>0?1:-1,0,""].join(",");v="rotate3d",d=x+y+"deg",p=x+m+"deg"}else{if(i)v="rotateX";else{if(!c)return f;v="rotateY"}d=y+"deg",p=m+"deg"}return f.set({transform:(r={},r[v]=[d,p],r)}),f}function u(e){var o=void 0===e?{}:e,i=o.properties,a=void 0===i?{transform:{translateX:["-10px","10px"],translateY:["-10px","10px"],rotate:["-10deg","10deg"]}}:i,c=o.frequency,s=void 0===c?10:c,u=new t.SceneItem({},arguments[0]),f=new t.Frame(a),v=f.getNames();return v.forEach((function(e,t){var o=f.get.apply(f,e),i=0,a=0,c="";if(r(o)){var v=n(o[0]),d=v.value;c=v.unit,i=d,a=n(o[1]).value}else{var p=n(o),l=p.value;c=p.unit,i=-(a=Math.abs(l))}u.set.apply(u,["0%"].concat(e,[""+(i+a)/2+c])),u.set.apply(u,["100%"].concat(e,[""+(i+a)/2+c]));for(var y=1;y<=s;++y){var m=Math.random()*(a-i)+i;u.set.apply(u,[y/(s+1)*100+"%"].concat(e,[""+m+c]))}})),u}e.blink=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?0:r,o=t.to,i=void 0===o?1:o;return c("opacity",[n,i,n],arguments[0])},e.fadeIn=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?0:r,o=t.to,i=void 0===o?1:o;return c("opacity",[n,i],arguments[0])},e.fadeOut=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?1:r,o=t.to,i=void 0===o?0:o;return c("opacity",[n,i],arguments[0])},e.flip=s,e.flipX=function(e){var t=void 0===e?{}:e,r=t.x,n=void 0===r?1:r,o=t.backside,i=void 0!==o&&o,a=s({y:0,x:n,backside:i});return a.setOptions(arguments[0]),a},e.flipY=function(e){var t=void 0===e?{}:e,r=t.y,n=void 0===r?1:r,o=t.backside,i=void 0!==o&&o,a=s({x:0,y:n,backside:i});return a.setOptions(arguments[0]),a},e.keyframer=function(e,r){return new t.SceneItem(function(e){for(var t=o(document.styleSheets).filter((function(e){try{return e.cssRules.length>0}catch(e){return!1}})),r=t.length,n=function(r){var n=o(t[r].cssRules).filter((function(t){return t.name===e&&t.type===i}))[0];if(n){var c=o(n.cssRules),s={};return c.forEach((function(e){if(e.type===a){var t=e.keyText,r=e.style.cssText;(n=t,o=n.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g),o?o.map((function(e){return e.trim()})):[]).forEach((function(e){s[e]=r}))}var n,o})),{value:s}}},c=0;c<r;++c){var s=n(c);if("object"==typeof s)return s.value}return{}}(e),r)},e.kineticFrame=function(e){var r=void 0===e?{}:e,n=r.leftProperty,o=void 0===n?["transform","translateX"]:n,i=r.topProperty,a=void 0===i?["transform","translateY"]:i,c=r.left,s=void 0===c?"0px":c,u=r.top,f=void 0===u?"0px":u,v=new t.Frame;return v.set.apply(v,[].concat(o).concat([s])),v.set.apply(v,[].concat(a).concat([f])),v.set("transform-origin","calc(50% - "+s+") calc(50% - "+f+")"),v},e.shake=u,e.shakeX=function(e){var t=void 0===e?{}:e,r=t.x,n=void 0===r?["-5px","5px"]:r,o=t.frequency,i=void 0===o?10:o,a=u({properties:{transform:{translateX:n}},frequency:i});return a.setOptions(arguments[0]),a},e.shakeY=function(e){var t=void 0===e?{}:e,r=t.y,n=void 0===r?["-5px","5px"]:r,o=t.frequency,i=void 0===o?10:o,a=u({properties:{transform:{translateY:n}},frequency:i});return a.setOptions(arguments[0]),a},e.transition=function(e,r,n){var o,i=new t.SceneItem;i.append(n);var a=i.getDuration(),c=Math.max(e.getDuration()-a,0);e.set(((o={})[c]=i,o)),i.setDirection("reverse"),r.set({0:i})},e.typing=function(e){var r=void 0===e?{}:e,n=r.property,o=void 0===n?["html"]:n,i=r.text,a=void 0===i?"":i,c=r.start,s=void 0===c?0:c,u=r.end,f=void 0===u?a.length:u,v=r.prefix,d=void 0===v?"":v,p=r.suffix,l=void 0===p?"":p,y=[].concat(o),m=new t.SceneItem,x=Math.abs(f-s)+1;if(s<f)for(var S=s;S<=f;++S)m.set.apply(m,[(S-s)/x*100+"%"].concat(y,[""+d+a.substring(s,S)+l]));else for(S=f;S<=s;++S)m.set.apply(m,[(S-f)/x*100+"%"].concat(y,[d+"text.substring(end, start + end - i)"+l]));return m.setOptions(arguments[0]),m},e.wipeIn=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?"-100%":r,o=t.to,i=void 0===o?"0%":o,a=t.property,s=void 0===a?"left":a;return c(s,[n,i],arguments[0])},e.wipeOut=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?"0%":r,o=t.to,i=void 0===o?"100%":o,a=t.property,s=void 0===a?"left":a;return c(s,[n,i],arguments[0])},e.zoomIn=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?0:r,o=t.to,i=void 0===o?1:o;return c(["transform","scale"],[n,i],arguments[0])},e.zoomOut=function(e){var t=void 0===e?{}:e,r=t.from,n=void 0===r?1:r,o=t.to,i=void 0===o?0:o;return c(["transform","scale"],[n,i],arguments[0])}}));